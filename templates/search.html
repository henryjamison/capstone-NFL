<!DOCTYPE html>
<html>

<head>
    <title>Search</title>
    <link rel="stylesheet" type="text/css" href="../static/search.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/select/1.7.0/css/select.dataTables.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.5.0/css/responsive.dataTables.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
    <script text="text/javascript" src="https://cdn.datatables.net/responsive/2.5.0/js/dataTables.responsive.min.js"></script>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/select/1.7.0/js/dataTables.select.min.js"></script> 
    <script>
        $(document).ready(function() {
            $('.playerTable').DataTable({
                select: true,
                scrollX:true,
                scrollY:true,
                responsive:true,
                initComplete: function () {
                    // Show the table once DataTables is ready
                    $('.playerTable').css('display', 'table');
                },
        });
        $(document).ready(function() {
        $('#text').on('keydown', function(event) {
            if (event.key === "Enter" && !event.shiftKey) {
                event.preventDefault(); // Prevent newline in textarea
                $('form').submit(); // Submit the form
            }
        });
    });
        });
    </script>
</head>

<body>
    <div class="container">
        <div id="header">
            <div class="left-header">
                <img id="logo" src="../static/fantasy-logo.png" alt="">
                <h1 id="logo-text">Fantasy Foresight</h1>
            </div>
            <div class="links">
                <a class="link" href="{{url_for('render_home')}}">Home</a>
                <a class="link" href="{{url_for('render_search')}}">Search</a>
                <a class="link" href="{{url_for('render_tables')}}">Team Stats</a>
            </div>
        </div>

        <div class="search">
            <div class="search-text">
                <h1>Find Your Next Star</h1>
            </div>
            <div class="search-bar">
                <form method="POST" onsubmit="{{url_for('render_search')}}">
                <input id="text" name="text" type="text" class="search-term" placeholder="Search for a player">
                <button type="submit" class="search-btn">
                    <iconify-icon icon="maki:arrow"></iconify-icon>
               </button>
                </form>
            </div>
        </div>

        {% if search %}
        <div class="features">
            {% if error %}
            <div class="message">
                <h2>{{ err_message }}</h2>
            </div>
            {% else %}
                <h2>Results for {{ name }}</h2>
            {% endif %}
            <div class="resTable">
                {% for table in tables %}
                <table class="playerTable">
                    <thead>
                        <tr>
                            {% for title in titles %}
                                <th>{{ title }}</th>
                            {% endfor %}
                        </tr>
                    </thead>
                    <tbody>
                        {{table | safe}}
                    </tbody>
                </table>
            {% endfor %}
            </div>
        </div>
        {% endif %}

        {% if not search and not error%}
        <div class="features">
            <div class="top-feature">
                <h1>Top 10 Performers this season</h1>
            </div>
            <div class="bottom-feature">
                {% for player in players %}
            <div class="inner-feature">
                <!-- {% for img_url in images %}
                <div class="img-background">
                    <img src="{{ img_url }}" alt="Image" width="300" height="200">
                </div>
            {% endfor %} -->
            <div class="img-background">
                <h1>{{player.Rank}}</h1>
            </div>
                <div class="player-info">
                    <h3>{{ player.Name }}</h3>
                    <p>Position: {{ player.Position }}</p>
                    <p>Team: {{ player.Team }}</p>
                    <p>Points: {{ player.Points }}</p>
                </div>
            </div>
            {% endfor %}
            </div>
        </div>

        {% endif %}

    </div>
</body>

</html>